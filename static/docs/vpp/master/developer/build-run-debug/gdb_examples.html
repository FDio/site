<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GDB Examples &mdash; The Vector Packet Processor v22.02-rc0-128-g4450b03ba
 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/rules.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Cross compilation on MacOS" href="cross_compile_macos.html" />
    <link rel="prev" title="Testing VPP" href="testing_vpp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> The Vector Packet Processor
            <img src="../../_static/fd-io_red_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v22.02-rc0-128-g4450b03ba

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/scalar-vs-vector-packet-processing.html">Scalar vs Vector packet processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/extensible.html">The Packet Processing Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/networkstack.html">Network Stack Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/hoststack.html">Host Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/developer.html">Additional features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/supported.html">Supported archs and OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/releasenotes/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../aboutvpp/featurelist.html">VPP Supported Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/containers/index.html">VPP with Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/simpleperf/index.html">VPP with Iperf3 and TRex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/vppcloud/index.html">VPP in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/vhost/index.html">VPP with Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/vmxnet3.html">VPP with VMware/Vmxnet3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/home_gateway.html">VPP as a Home Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/acls.html">Access Control Lists with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/networksim.html">Generating traffic with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/webapp.html">Web applications with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/container_test.html">Simulating networks with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/trafficgen.html">Stateless Traffic Gen with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/ikev2/index.html">IKEv2 with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/contiv/index.html">VPP in kubernetes (Contiv/Deprecated)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/installing/index.html">Downloading and Installing VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/running/index.html">Running VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/progressivevpp/index.html">Progressive VPP Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted/troubleshooting/index.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Build, Run &amp; Debug</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="building.html">Building VPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="running_vpp.html">Running VPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="testing_vpp.html">Testing VPP</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GDB Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#starting-gdb">Starting GDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="#backtrace">Backtrace</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-to-the-gdb-prompt">Get to the GDB prompt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#breakpoints">Breakpoints</a></li>
<li class="toctree-l3"><a class="reference internal" href="#step-next-list">Step/Next/List</a></li>
<li class="toctree-l3"><a class="reference internal" href="#examining-data-and-packets">Examining Data and packets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cross_compile_macos.html">Cross compilation on MacOS</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../corearchitecture/index.html">Core Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../corefeatures/index.html">Core Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugindoc/index.html">Adding a new plugin or feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicedrivers/index.html">Device drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tests/overview.html">VPP Test Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../extras/index.html">VPP extra tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfacing with VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/binapi/index.html">The binary API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/c/index.html">C api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/cpp/index.html">C++ api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/go/index.html">Go api (govpp)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/rust/index.html">Rust api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../interfacing/libmemif/index.html">Memif library (libmemif)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/gitreview.html">Getting a Patch Reviewed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/writingdocs.html">Writing VPP Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/reportingissues/index.html">Reporting Bugs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debug CLI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../cli-reference/gettingstarted/index.html">Getting Started with the debug CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli-reference/interface/index.html">Interface Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli-reference/index.html">Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration file</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/config_getting_started.html">Getting started with the configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../configuration/reference.html">Configuration Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Vector Packet Processor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">Build, Run &amp; Debug</a> &raquo;</li>
      <li>GDB Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/developer/build-run-debug/gdb_examples.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="toctree-wrapper compound" id="gdb-examples">
</div>
<section id="id1">
<h1>GDB Examples<a class="headerlink" href="#id1" title="Permalink to this headline"></a></h1>
<p>In this section we have a few useful gdb commands.</p>
<section id="starting-gdb">
<h2>Starting GDB<a class="headerlink" href="#starting-gdb" title="Permalink to this headline"></a></h2>
<p>Once at the gdb prompt, VPP can be started by running the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">run -c /etc/vpp/startup.conf</span>
<span class="go">Starting program: /scratch/vpp-master/build-root/install-vpp_debug-native/vpp/bin/vpp -c /etc/vpp/startup.conf</span>
<span class="go"> [Thread debugging using libthread_db enabled]</span>
<span class="go"> Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.</span>
<span class="go"> vlib_plugin_early_init:361: plugin path /scratch/vpp-master/build-root/install-vpp_debug-native/vpp/lib/vpp_plugins:/scratch/vpp-master/build-root/install-vpp_debug-native/vpp/lib/vpp_plugins</span>
<span class="go"> ....</span>
</pre></div>
</div>
</section>
<section id="backtrace">
<h2>Backtrace<a class="headerlink" href="#backtrace" title="Permalink to this headline"></a></h2>
<p>If you encounter errors when running VPP, such as VPP terminating due to a segfault
or abort signal, then you can run the VPP debug binary and then execute <strong>backtrace</strong> or <strong>bt</strong>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">bt</span>
<span class="gp">#</span><span class="m">0</span>  ip4_icmp_input <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, <span class="nv">node</span><span class="o">=</span>0x7fffb6bb6900, <span class="nv">frame</span><span class="o">=</span>0x7fffb6725ac0<span class="o">)</span> at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:187
<span class="gp">#</span><span class="m">1</span>  0x00007ffff78da4be <span class="k">in</span> dispatch_node <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, <span class="nv">node</span><span class="o">=</span>0x7fffb6bb    <span class="m">6900</span>, <span class="nv">type</span><span class="o">=</span>VLIB_NODE_TYPE_INTERNAL, <span class="nv">dispatch_state</span><span class="o">=</span>VLIB_NODE_STATE_POLLING, <span class="nv">frame</span><span class="o">=</span>0x7fffb6725ac0, <span class="nv">last_time_stamp</span><span class="o">=</span><span class="m">10581236529</span>    <span class="m">65565</span><span class="o">)</span> at /scratch/vpp-master/build-data/../src/vlib/main.c:988
<span class="gp">#</span><span class="m">2</span>  0x00007ffff78daa77 <span class="k">in</span> dispatch_pending_node <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, <span class="nv">pending_frame_index</span><span class="o">=</span><span class="m">6</span>, <span class="nv">last_time_stamp</span><span class="o">=</span><span class="m">1058123652965565</span><span class="o">)</span> at /scratch/vpp-master/build-data/../src/vlib/main.c:1138
<span class="go">....</span>
</pre></div>
</div>
</section>
<section id="get-to-the-gdb-prompt">
<h2>Get to the GDB prompt<a class="headerlink" href="#get-to-the-gdb-prompt" title="Permalink to this headline"></a></h2>
<p>When VPP is running, you can get to the command prompt by pressing <strong>CTRL+C</strong>.</p>
</section>
<section id="breakpoints">
<h2>Breakpoints<a class="headerlink" href="#breakpoints" title="Permalink to this headline"></a></h2>
<p>When at the GDB prompt, set a breakpoint by running the commands below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">break ip4_icmp_input</span>
<span class="go">Breakpoint 4 at 0x7ffff6b9c00b: file /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c, line 142.</span>
</pre></div>
</div>
<p>List the breakpoints already set:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">i b</span>
<span class="go">Num     Type           Disp Enb Address            What</span>
<span class="go">1       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">    breakpoint already hit 3 times</span>
<span class="go">2       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">3       breakpoint     keep y   0x00007ffff640f646 in tw_timer_expire_timers_internal_1t_3w_1024sl_ov</span>
<span class="go">    at /scratch/vpp-master/build-data/../src/vppinfra/tw_timer_template.c:775</span>
</pre></div>
</div>
<p>Delete a breakpoint:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">del 2</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">i b</span>
<span class="go">Num     Type           Disp Enb Address            What</span>
<span class="go">1       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">    breakpoint already hit 3 times</span>
<span class="go">3       breakpoint     keep y   0x00007ffff640f646 in tw_timer_expire_timers_internal_1t_3w_1024sl_ov</span>
<span class="go">    at /scratch/vpp-master/build-data/../src/vppinfra/tw_timer_template.c:775</span>
</pre></div>
</div>
</section>
<section id="step-next-list">
<h2>Step/Next/List<a class="headerlink" href="#step-next-list" title="Permalink to this headline"></a></h2>
<p>Step through the code using (s)tep into, (n)ext, and list some lines before and after where you are with list.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Thread 1 &quot;vpp_main&quot; hit Breakpoint 1, ip4_icmp_input (vm=0x7ffff7b89a40 &lt;vlib_global_main&gt;, node=0x7fffb6bb6900, frame=0x7fffb6709480)</span>
<span class="go">    at /scratch/jdenisco/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">142 {</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">n</span>
<span class="go">143   icmp4_main_t *im = &amp;icmp4_main;</span>
<span class="go">(</span>
<span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">list</span>
<span class="go">202       vlib_put_next_frame (vm, node, next, n_left_to_next);</span>
<span class="go">203     }</span>
<span class="go">204</span>
<span class="go">205   return frame-&gt;n_vectors;</span>
<span class="go">206 }</span>
<span class="go">207</span>
<span class="go">208 /* *INDENT-OFF* */</span>
<span class="go">209 VLIB_REGISTER_NODE (ip4_icmp_input_node,static) = {</span>
<span class="go">210   .function = ip4_icmp_input,</span>
<span class="go">211   .name = &quot;ip4-icmp-input&quot;,</span>
</pre></div>
</div>
</section>
<section id="examining-data-and-packets">
<h2>Examining Data and packets<a class="headerlink" href="#examining-data-and-packets" title="Permalink to this headline"></a></h2>
<p>To look at data and packets use e(x)amine or (p)rint.</p>
<p>For example in this code look at the ip packet:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">p/x *ip0</span>
<span class="gp">$</span><span class="nv">3</span> <span class="o">=</span> <span class="o">{{</span><span class="nv">ip_version_and_header_length</span> <span class="o">=</span> 0x45, <span class="nv">tos</span> <span class="o">=</span> 0x0, <span class="nv">length</span> <span class="o">=</span> 0x5400,
<span class="go">fragment_id = 0x7049, flags_and_fragment_offset = 0x40, ttl = 0x40, protocol = 0x1,</span>
<span class="go">checksum = 0x2ddd, {{src_address = {data = {0xa, 0x0, 0x0, 0x2},</span>
<span class="go">data_u32 = 0x200000a, as_u8 = {0xa, 0x0, 0x0, 0x2}, as_u16 = {0xa, 0x200},</span>
<span class="go">as_u32 = 0x200000a}, dst_address = {data = {0xa, 0x0, 0x0, 0xa}, data_u32 = 0xa00000a,</span>
<span class="go">as_u8 = {0xa, 0x0, 0x0, 0xa}, as_u16 = {0xa, 0xa00},  as_u32 = 0xa00000a}},</span>
<span class="go">address_pair = {src = {data = {0xa, 0x0, 0x0, 0x2}, data_u32 = 0x200000a,</span>
<span class="go">as_u8 = {0xa, 0x0, 0x0, 0x2}, as_u16 = {0xa, 0x200},  as_u32 = 0x200000a},</span>
<span class="go">dst = {data = {0xa, 0x0, 0x0, 0xa}, data_u32 = 0xa00000a, as_u8 = {0xa, 0x0, 0x0, 0xa},</span>
<span class="go">as_u16 = {0xa, 0xa00}, as_u32 = 0xa00000a}}}}, {checksum_data_64 =</span>
<span class="go">{0x40704954000045, 0x200000a2ddd0140}, checksum_data_64_32 = {0xa00000a}},</span>
<span class="go">{checksum_data_32 = {0x54000045, 0x407049, 0x2ddd0140, 0x200000a, 0xa00000a}}}</span>
</pre></div>
</div>
<p>Then the icmp header</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">p/x *icmp0</span>
<span class="gp">$</span><span class="nv">4</span> <span class="o">=</span> <span class="o">{</span><span class="nb">type</span> <span class="o">=</span> 0x8, <span class="nv">code</span> <span class="o">=</span> 0x0, <span class="nv">checksum</span> <span class="o">=</span> 0xf148<span class="o">}</span>
</pre></div>
</div>
<p>Then look at the actual bytes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp gp-VirtualEnv">(gdb)</span> <span class="go">x/50w ip0</span>
<span class="go">0x7fde9953510e:     0x54000045      0x00407049      0x2ddd0140      0x0200000a</span>
<span class="go">0x7fde9953511e:     0x0a00000a      0xf1480008      0x03000554      0x5b6b2e8a</span>
<span class="go">0x7fde9953512e:     0x00000000      0x000ca99a      0x00000000      0x13121110</span>
<span class="go">0x7fde9953513e:     0x17161514      0x1b1a1918      0x1f1e1d1c      0x23222120</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="testing_vpp.html" class="btn btn-neutral float-left" title="Testing VPP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cross_compile_macos.html" class="btn btn-neutral float-right" title="Cross compilation on MacOS" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, Linux Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>