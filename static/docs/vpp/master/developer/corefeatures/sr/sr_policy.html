<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Creating a SR Policy &mdash; The Vector Packet Processor v22.02-rc0-128-g4450b03ba
 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/rules.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Steering packets into a SR Policy" href="sr_steering.html" />
    <link rel="prev" title="SR-MPLS: Segment Routing for MPLS" href="sr_mpls.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> The Vector Packet Processor
            <img src="../../../_static/fd-io_red_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v22.02-rc0-128-g4450b03ba

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/scalar-vs-vector-packet-processing.html">Scalar vs Vector packet processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/extensible.html">The Packet Processing Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/networkstack.html">Network Stack Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/hoststack.html">Host Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/developer.html">Additional features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/supported.html">Supported archs and OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/releasenotes/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/featurelist.html">VPP Supported Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/containers/index.html">VPP with Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/simpleperf/index.html">VPP with Iperf3 and TRex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vppcloud/index.html">VPP in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vhost/index.html">VPP with Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vmxnet3.html">VPP with VMware/Vmxnet3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/home_gateway.html">VPP as a Home Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/acls.html">Access Control Lists with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/networksim.html">Generating traffic with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/webapp.html">Web applications with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/container_test.html">Simulating networks with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/trafficgen.html">Stateless Traffic Gen with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/ikev2/index.html">IKEv2 with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/contiv/index.html">VPP in kubernetes (Contiv/Deprecated)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/installing/index.html">Downloading and Installing VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/running/index.html">Running VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/progressivevpp/index.html">Progressive VPP Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/troubleshooting/index.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../build-run-debug/index.html">Build, Run &amp; Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../corearchitecture/index.html">Core Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Core Features</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../fib/index.html">The FIB</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Segment routing</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="sr_doc.html">SRv6: Segment Routing for IPv6</a></li>
<li class="toctree-l3"><a class="reference internal" href="sr_localsid.html">SR LocalSIDs</a></li>
<li class="toctree-l3"><a class="reference internal" href="sr_mpls.html">SR-MPLS: Segment Routing for MPLS</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Creating a SR Policy</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#adding-removing-sid-lists-from-an-sr-policy">Adding/Removing SID Lists from an SR policy</a></li>
<li class="toctree-l4"><a class="reference internal" href="#sr-policies-spray-policies">SR Policies: Spray policies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#encapsulation-sr-policies">Encapsulation SR policies</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="sr_steering.html">Steering packets into a SR Policy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../punt.html">Punting Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipsec.html">IPSec (IP Security)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfd_doc.html">BFD module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipfix_doc.html">IPFIX support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../span_doc.html">Switched Port Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtu.html">MTU in VPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sylog_doc.html">Syslog protocol support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eventviewer.html">Event-logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats.html">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selinux_doc.html">SELinux - VPP Custom SELinux Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugindoc/index.html">Adding a new plugin or feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicedrivers/index.html">Device drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tests/overview.html">VPP Test Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extras/index.html">VPP extra tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfacing with VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/binapi/index.html">The binary API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/c/index.html">C api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/cpp/index.html">C++ api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/go/index.html">Go api (govpp)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/rust/index.html">Rust api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/libmemif/index.html">Memif library (libmemif)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/gitreview.html">Getting a Patch Reviewed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/writingdocs.html">Writing VPP Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/reportingissues/index.html">Reporting Bugs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debug CLI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/gettingstarted/index.html">Getting Started with the debug CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/interface/index.html">Interface Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/index.html">Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration file</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/config_getting_started.html">Getting started with the configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/reference.html">Configuration Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Vector Packet Processor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Core Features</a> &raquo;</li>
          <li><a href="index.html">Segment routing</a> &raquo;</li>
      <li>Creating a SR Policy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/corefeatures/sr/sr_policy.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="creating-a-sr-policy">
<span id="srv6-policy-doc"></span><h1>Creating a SR Policy<a class="headerlink" href="#creating-a-sr-policy" title="Permalink to this headline"></a></h1>
<p>An SR Policy is defined by a Binding SID and a weighted set of Segment
Lists.</p>
<p>A new SR policy is created with a first SID list using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="n">add</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span> <span class="nb">next</span> <span class="n">A1</span><span class="p">::</span> <span class="nb">next</span> <span class="n">B1</span><span class="p">::</span> <span class="nb">next</span> <span class="n">C1</span><span class="p">::</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">5</span><span class="p">)</span> <span class="p">(</span><span class="n">fib</span><span class="o">-</span><span class="n">table</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>The weight parameter is only used if more than one SID list is
associated with the policy.</p></li>
<li><p>The fib-table parameter specifies in which table (VRF) the Binding
SID is to be installed.</p></li>
</ul>
<p>An SR policy is deleted with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="k">del</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span>
<span class="n">sr</span> <span class="n">policy</span> <span class="k">del</span> <span class="n">index</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The existing SR policies are listed with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">show</span> <span class="n">sr</span> <span class="n">policies</span>
</pre></div>
</div>
<section id="adding-removing-sid-lists-from-an-sr-policy">
<h2>Adding/Removing SID Lists from an SR policy<a class="headerlink" href="#adding-removing-sid-lists-from-an-sr-policy" title="Permalink to this headline"></a></h2>
<p>An additional SID list is associated with an existing SR policy with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span> <span class="n">add</span> <span class="n">sl</span> <span class="nb">next</span> <span class="n">A2</span><span class="p">::</span> <span class="nb">next</span> <span class="n">B2</span><span class="p">::</span> <span class="nb">next</span> <span class="n">C2</span><span class="p">::</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">index</span> <span class="mi">3</span>      <span class="n">add</span> <span class="n">sl</span> <span class="nb">next</span> <span class="n">A2</span><span class="p">::</span> <span class="nb">next</span> <span class="n">B2</span><span class="p">::</span> <span class="nb">next</span> <span class="n">C2</span><span class="p">::</span> <span class="p">(</span><span class="n">weight</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>Conversely, a SID list can be removed from an SR policy with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span> <span class="k">del</span> <span class="n">sl</span> <span class="n">index</span> <span class="mi">1</span>
<span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">index</span> <span class="mi">3</span>      <span class="k">del</span> <span class="n">sl</span> <span class="n">index</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Note that this cannot be used to remove the last SID list of a policy.</p>
<p>The weight of a SID list can also be modified with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span> <span class="n">mod</span> <span class="n">sl</span> <span class="n">index</span> <span class="mi">1</span> <span class="n">weight</span> <span class="mi">4</span>
<span class="n">sr</span> <span class="n">policy</span> <span class="n">mod</span> <span class="n">index</span> <span class="mi">3</span>      <span class="n">mod</span> <span class="n">sl</span> <span class="n">index</span> <span class="mi">1</span> <span class="n">weight</span> <span class="mi">4</span>
</pre></div>
</div>
</section>
<section id="sr-policies-spray-policies">
<h2>SR Policies: Spray policies<a class="headerlink" href="#sr-policies-spray-policies" title="Permalink to this headline"></a></h2>
<p>Spray policies are a specific type of SR policies where the packet is
replicated on all the SID lists, rather than load-balanced among them.</p>
<p>SID list weights are ignored with this type of policies.</p>
<p>A Spray policy is instantiated by appending the keyword <strong>spray</strong> to a
regular SR policy command, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sr</span> <span class="n">policy</span> <span class="n">add</span> <span class="n">bsid</span> <span class="mi">2001</span><span class="p">::</span><span class="mi">1</span> <span class="nb">next</span> <span class="n">A1</span><span class="p">::</span> <span class="nb">next</span> <span class="n">B1</span><span class="p">::</span> <span class="nb">next</span> <span class="n">C1</span><span class="p">::</span> <span class="n">spray</span>
</pre></div>
</div>
<p>Spray policies are used for removing multicast state from a network core
domain, and instead send a linear unicast copy to every access node. The
last SID in each list accesses the multicast tree within the access
node.</p>
</section>
<section id="encapsulation-sr-policies">
<h2>Encapsulation SR policies<a class="headerlink" href="#encapsulation-sr-policies" title="Permalink to this headline"></a></h2>
<p>In case the user decides to create an SR policy an IPv6 Source Address
must be specified for the encapsulated traffic. In order to do so the
user might use the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">sr</span> <span class="n">encaps</span> <span class="n">source</span> <span class="n">addr</span> <span class="n">XXXX</span><span class="p">::</span><span class="n">YYYY</span>
</pre></div>
</div>
<p>Default hop-limit for the encapsulating IPv6 header is 64. It is
possible to specify custom hop-limit value from 1 to 255 using this
command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">sr</span> <span class="n">encaps</span> <span class="n">hop</span><span class="o">-</span><span class="n">limit</span> <span class="n">N</span>
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sr_mpls.html" class="btn btn-neutral float-left" title="SR-MPLS: Segment Routing for MPLS" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="sr_steering.html" class="btn btn-neutral float-right" title="Steering packets into a SR Policy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, Linux Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>