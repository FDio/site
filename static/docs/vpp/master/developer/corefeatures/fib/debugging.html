<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Debugging &mdash; The Vector Packet Processor v22.02-rc0-128-g4450b03ba
 documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/rules.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Fast Convergence" href="fastconvergence.html" />
    <link rel="prev" title="IP Multicast FIB" href="multicast.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> The Vector Packet Processor
            <img src="../../../_static/fd-io_red_white.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                v22.02-rc0-128-g4450b03ba

              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/scalar-vs-vector-packet-processing.html">Scalar vs Vector packet processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/extensible.html">The Packet Processing Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/networkstack.html">Network Stack Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/hoststack.html">Host Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/developer.html">Additional features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/supported.html">Supported archs and OS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/releasenotes/index.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../aboutvpp/featurelist.html">VPP Supported Features</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Use Cases</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/containers/index.html">VPP with Containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/simpleperf/index.html">VPP with Iperf3 and TRex</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vppcloud/index.html">VPP in the Cloud</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vhost/index.html">VPP with Virtual Machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/vmxnet3.html">VPP with VMware/Vmxnet3</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/home_gateway.html">VPP as a Home Gateway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/acls.html">Access Control Lists with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/networksim.html">Generating traffic with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/webapp.html">Web applications with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/container_test.html">Simulating networks with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/trafficgen.html">Stateless Traffic Gen with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/ikev2/index.html">IKEv2 with VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../usecases/contiv/index.html">VPP in kubernetes (Contiv/Deprecated)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/installing/index.html">Downloading and Installing VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/running/index.html">Running VPP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/progressivevpp/index.html">Progressive VPP Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted/troubleshooting/index.html">Troubleshooting</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer Documentation</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../build-run-debug/index.html">Build, Run &amp; Debug</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../corearchitecture/index.html">Core Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Core Features</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html">The FIB</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="prerequisites.html">Prerequisites</a></li>
<li class="toctree-l3"><a class="reference internal" href="thedatamodel.html">The Data Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="tunnels.html">Tunnels</a></li>
<li class="toctree-l3"><a class="reference internal" href="mplsfib.html">MPLS FIB</a></li>
<li class="toctree-l3"><a class="reference internal" href="multicast.html">IP Multicast FIB</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="fastconvergence.html">Fast Convergence</a></li>
<li class="toctree-l3"><a class="reference internal" href="scale.html">Scale</a></li>
<li class="toctree-l3"><a class="reference internal" href="barnacles.html">Barnacles</a></li>
<li class="toctree-l3"><a class="reference internal" href="hacking.html">Get Hacking</a></li>
<li class="toctree-l3"><a class="reference internal" href="missing.html">Missing Functionality</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../sr/index.html">Segment routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../punt.html">Punting Packets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipsec.html">IPSec (IP Security)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bfd_doc.html">BFD module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ipfix_doc.html">IPFIX support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../span_doc.html">Switched Port Analyzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mtu.html">MTU in VPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sylog_doc.html">Syslog protocol support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../eventviewer.html">Event-logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stats.html">Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../selinux_doc.html">SELinux - VPP Custom SELinux Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../plugindoc/index.html">Adding a new plugin or feature</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins/index.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devicedrivers/index.html">Device drivers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tests/overview.html">VPP Test Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../extras/index.html">VPP extra tools</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interfacing with VPP</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/binapi/index.html">The binary API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/c/index.html">C api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/cpp/index.html">C++ api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/go/index.html">Go api (govpp)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/rust/index.html">Rust api client</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../interfacing/libmemif/index.html">Memif library (libmemif)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/gitreview.html">Getting a Patch Reviewed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/writingdocs.html">Writing VPP Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/reportingissues/index.html">Reporting Bugs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debug CLI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/gettingstarted/index.html">Getting Started with the debug CLI</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/interface/index.html">Interface Commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../cli-reference/index.html">Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Configuration file</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/config_getting_started.html">Getting started with the configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../configuration/reference.html">Configuration Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">The Vector Packet Processor</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../index.html">Core Features</a> &raquo;</li>
          <li><a href="index.html">The FIB</a> &raquo;</li>
      <li>Debugging</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/developer/corefeatures/fib/debugging.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="debugging">
<span id="id1"></span><h1>Debugging<a class="headerlink" href="#debugging" title="Permalink to this headline"></a></h1>
<p>the anatomy of a route:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">BGvpp# sh ip fib 1.1.1.3/32</span>
<span class="go">ipv4-VRF:0, fib_index:0, flow hash:[src dst sport dport proto ] epoch:0 flags:none locks:[adjacency:1, recursive-resolution:4, default-route:1, ]</span>
<span class="go">1.1.1.0/24 fib:0 index:9 locks:2</span>
<span class="go">  CLI refs:1 src-flags:added,contributing,active,</span>
<span class="go">    path-list:[24] locks:4 flags:shared, uPRF-list:11 len:1 itfs:[1, ]</span>
<span class="go">      path:[26] pl-index:24 ip4 weight=1 pref=0 attached-nexthop:  oper-flags:resolved,</span>
<span class="go">        10.0.0.1 loop0</span>
<span class="go">      [@0]: arp-ipv4: via 10.0.0.1 loop0</span>

<span class="go"> forwarding:   unicast-ip4-chain</span>
<span class="go">  [@0]: dpo-load-balance: [proto:ip4 index:11 buckets:1 uRPF:11 to:[0:0]]</span>
<span class="go">    [0] [@3]: arp-ipv4: via 10.0.0.1 loop0</span>
</pre></div>
</div>
<p>let’s go line by line.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">ipv4-VRF:0, fib_index:0, flow hash:[src dst sport dport proto ] epoch:0 flags:none locks:[adjacency:1, recursive-resolution:4, default-route:1, ]</span>
</pre></div>
</div>
<p>Each field in turn:</p>
<ul class="simple">
<li><p>ipv4-VRF:0: the name of the table (as given by the user, or
automatically generated by VPP).</p></li>
<li><p>fib-index:0; in the VPP pool of FIB objects, this is index 0</p></li>
<li><p>flow hash:[src dst sport dport proto ]: When calculating the flow
hash to use for load-balancing, these are the fields in the packet
that are used. There is an API to change this per-table.</p></li>
<li><p>epoch:0; Used during mark-n-sweep.</p></li>
<li><p>flags:none; use the force, to find the per-table flags.</p></li>
<li><p>locks: per-source reference counting, a table can only be deleted
when all sources no longer reference it.</p></li>
</ul>
<p>next line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">1.1.1.0/24 fib:0 index:9 locks:2</span>
</pre></div>
</div>
<p>this shows the route that matched the show request. note that it is not
an exact match, it’s an LPM. The route is in FIB index 0, its index
(in the VPP pool of fib_entry_t objects) is nine and there are two
references to the entry.
You’ll get the same output if you type “sh fib entry 9”</p>
<p>next line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">CLI refs:1 src-flags:added,contributing,active,</span>
</pre></div>
</div>
<p>the ‘CLI’ has sourced this route (it was added via CLI). This source
has been added (well duh) it is ‘active’, meaning it is the best
source, and it is contributing a forwarding object. There are some
scenarios where sources other than the active source contribute,
namely interpose sources.</p>
<p>next line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">path-list:[24] locks:4 flags:shared, uPRF-list:11 len:1 itfs:[1, ]</span>
</pre></div>
</div>
<p>This is path-list inex 24 (see “sh fib path-list 24” this will also
show the  children), it is ‘shared’,
meaning that if other prefixes were to use the same set of paths,
then they would also use this path-list object. It has uRPF list 11 of
length 1 containing interface index 1 (which is loop0, see “sh int”).</p>
<p>next line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">path:[26] pl-index:24 ip4 weight=1 pref=0 attached-nexthop:  oper-flags:resolved,</span>
<span class="go">  10.0.0.1 loop0</span>
<span class="go">[@0]: arp-ipv4: via 10.0.0.1 loop0</span>
</pre></div>
</div>
<p>This is path 26 (see “sh fib path 26”). It’s a member of
path-list 24. It’s ip4 has a weight of 1 and a preference of 0. It’s
of type ‘attached-nexthop’ and currently resolved - woohoo.
It is a path ‘via 10.0.0.1 loop0’. It is contributing an incomplete adjacency.</p>
<p>next line:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">forwarding:   unicast-ip4-chain</span>
<span class="go">  [@0]: dpo-load-balance: [proto:ip4 index:11 buckets:1 uRPF:11 to:[0:0]]</span>
<span class="go">    [0] [@3]: arp-ipv4: via 10.0.0.1 loop0</span>
</pre></div>
</div>
<p>This section describes how packets of type ‘unicast-ip4’ will be
forwarded. It is the result of processing the path information from
above.
Here we see load-balance object 11, which has 1 bucket/choice. It is
also linked to uRPF instance 11 (which it got from path-list 24).
In bucket 0 there is the incomplete adjacency that was contributed by
path 26.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="multicast.html" class="btn btn-neutral float-left" title="IP Multicast FIB" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="fastconvergence.html" class="btn btn-neutral float-right" title="Fast Convergence" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018-2021, Linux Foundation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>