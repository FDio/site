

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>GDB Examples &mdash; Vector Packet Processor 01 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/rules.css" type="text/css" />
    <link rel="author" title="About these documents" href="../../about.html" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Adding a plugin" href="add_plugin.html" />
    <link rel="prev" title="Running VPP" href="running_vpp.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Vector Packet Processor
          

          
            
            <img src="../../_static/fd-io_red_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                19.08
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../overview/index.html">Overview</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installing/index.html">Downloading and Installing VPP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../progressivevpp/index.html">Progressive VPP Tutorial</a></li>
<li class="toctree-l2"><a class="reference internal" href="../users/index.html">For Users</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">For Developers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="building.html">Building VPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="running_vpp.html">Running VPP</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">GDB Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#starting-gdb">Starting GDB</a></li>
<li class="toctree-l4"><a class="reference internal" href="#backtrace">Backtrace</a></li>
<li class="toctree-l4"><a class="reference internal" href="#get-to-the-gdb-prompt">Get to the GDB prompt</a></li>
<li class="toctree-l4"><a class="reference internal" href="#breakpoints">Breakpoints</a></li>
<li class="toctree-l4"><a class="reference internal" href="#step-next-list">Step/Next/List</a></li>
<li class="toctree-l4"><a class="reference internal" href="#examining-data-and-packets">Examining Data and packets</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="add_plugin.html">Adding a plugin</a></li>
<li class="toctree-l3"><a class="reference internal" href="gitreview.html">Getting a Patch Reviewed</a></li>
<li class="toctree-l3"><a class="reference internal" href="softwarearchitecture.html">Software Architecture</a></li>
<li class="toctree-l3"><a class="reference internal" href="infrastructure.html">VPPINFRA (Infrastructure)</a></li>
<li class="toctree-l3"><a class="reference internal" href="vlib.html">VLIB (Vector Processing Library)</a></li>
<li class="toctree-l3"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l3"><a class="reference internal" href="vnet.html">VNET (VPP Network Stack)</a></li>
<li class="toctree-l3"><a class="reference internal" href="featurearcs.html">Feature Arcs</a></li>
<li class="toctree-l3"><a class="reference internal" href="metadata.html">Buffer Metadata</a></li>
<li class="toctree-l3"><a class="reference internal" href="metadata.html#buffer-metadata-extensions">Buffer Metadata Extensions</a></li>
<li class="toctree-l3"><a class="reference internal" href="multiarch/index.html">Multi-architecture support</a></li>
<li class="toctree-l3"><a class="reference internal" href="bihash.html">Bounded-index Extensible Hashing (bihash)</a></li>
<li class="toctree-l3"><a class="reference internal" href="vpp_api_module.html">VPP API module</a></li>
<li class="toctree-l3"><a class="reference internal" href="binary_api_support.html">Binary API Support</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildsystem/index.html">Build System</a></li>
<li class="toctree-l3"><a class="reference internal" href="eventviewer.html">Event-logger</a></li>
<li class="toctree-l3"><a class="reference internal" href="eventviewer.html#g2-graphical-event-viewer">G2 graphical event viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="fib20/index.html">FIB 2.0 Hierarchical, Protocol, Independent</a></li>
<li class="toctree-l3"><a class="reference internal" href="buildwireshark.html">How to build a vpp dispatch trace aware Wireshark</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../writingdocs/index.html">Writing Documents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../links/index.html">VPP Wiki, Doxygen and Other Links</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usecases/index.html">Use Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../featuresbyrelease/index.html">Features by Release</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../troubleshooting/index.html">Troubleshooting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../events/index.html">Events</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../reference/index.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../relatedprojects/index.html">Related Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../archive/index.html">Archive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../about.html">About</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vector Packet Processor</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Getting Started</a> &raquo;</li>
        
          <li><a href="index.html">For Developers</a> &raquo;</li>
        
      <li>GDB Examples</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/gettingstarted/developers/gdb_examples.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="toctree-wrapper compound" id="gdb-examples">
</div>
<div class="section" id="id1">
<h1>GDB Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<p>In this section we have a few useful gdb commands.</p>
<div class="section" id="starting-gdb">
<h2>Starting GDB<a class="headerlink" href="#starting-gdb" title="Permalink to this headline">¶</a></h2>
<p>Once at the gdb prompt, VPP can be started by running the following commands:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) run -c /etc/vpp/startup.conf</span>
<span class="go">Starting program: /scratch/vpp-master/build-root/install-vpp_debug-native/vpp/bin/vpp -c /etc/vpp/startup.conf</span>
<span class="go"> [Thread debugging using libthread_db enabled]</span>
<span class="go"> Using host libthread_db library &quot;/lib/x86_64-linux-gnu/libthread_db.so.1&quot;.</span>
<span class="go"> vlib_plugin_early_init:361: plugin path /scratch/vpp-master/build-root/install-vpp_debug-native/vpp/lib/vpp_plugins:/scratch/vpp-master/build-root/install-vpp_debug-native/vpp/lib/vpp_plugins</span>
<span class="go"> ....</span>
</pre></div>
</div>
</div>
<div class="section" id="backtrace">
<h2>Backtrace<a class="headerlink" href="#backtrace" title="Permalink to this headline">¶</a></h2>
<p>If you encounter errors when running VPP, such as VPP terminating due to a segfault
or abort signal, then you can run the VPP debug binary and then execute <strong>backtrace</strong> or <strong>bt</strong>.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) bt</span>
<span class="gp">#</span><span class="m">0</span>  ip4_icmp_input <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, <span class="nv">node</span><span class="o">=</span>0x7fffb6bb6900, <span class="nv">frame</span><span class="o">=</span>0x7fffb6725ac0<span class="o">)</span> at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:187
<span class="gp">#</span><span class="m">1</span>  0x00007ffff78da4be in dispatch_node <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, <span class="nv">node</span><span class="o">=</span>0x7fffb6bb    <span class="m">6900</span>, <span class="nv">type</span><span class="o">=</span>VLIB_NODE_TYPE_INTERNAL, <span class="nv">dispatch_state</span><span class="o">=</span>VLIB_NODE_STATE_POLLING, <span class="nv">frame</span><span class="o">=</span>0x7fffb6725ac0, <span class="nv">last_time_stamp</span><span class="o">=</span><span class="m">10581236529</span>    <span class="m">65565</span><span class="o">)</span> at /scratch/vpp-master/build-data/../src/vlib/main.c:988
<span class="gp">#</span><span class="m">2</span>  0x00007ffff78daa77 in dispatch_pending_node <span class="o">(</span><span class="nv">vm</span><span class="o">=</span>0x7ffff7b89a40 &lt;vlib_global_main&gt;, pending_f    <span class="nv">rame_index</span><span class="o">=</span><span class="m">6</span>, <span class="nv">last_time_stamp</span><span class="o">=</span><span class="m">1058123652965565</span><span class="o">)</span> at /scratch/vpp-master/build-data/../src/vlib/main.c:1138
<span class="go">....</span>
</pre></div>
</div>
</div>
<div class="section" id="get-to-the-gdb-prompt">
<h2>Get to the GDB prompt<a class="headerlink" href="#get-to-the-gdb-prompt" title="Permalink to this headline">¶</a></h2>
<p>When VPP is running, you can get to the command prompt by pressing <strong>CTRL+C</strong>.</p>
</div>
<div class="section" id="breakpoints">
<h2>Breakpoints<a class="headerlink" href="#breakpoints" title="Permalink to this headline">¶</a></h2>
<p>When at the GDB prompt, set a breakpoint by running the commands below:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) break ip4_icmp_input</span>
<span class="go">Breakpoint 4 at 0x7ffff6b9c00b: file /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c, line 142.</span>
</pre></div>
</div>
<p>List the breakpoints already set:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) i b</span>
<span class="go">Num     Type           Disp Enb Address            What</span>
<span class="go">1       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">    breakpoint already hit 3 times</span>
<span class="go">2       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">3       breakpoint     keep y   0x00007ffff640f646 in tw_timer_expire_timers_internal_1t_3w_1024sl_ov</span>
<span class="go">    at /scratch/vpp-master/build-data/../src/vppinfra/tw_timer_template.c:775</span>
</pre></div>
</div>
<p>Delete a breakpoint:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) del 2</span>
<span class="go">(gdb) i b</span>
<span class="go">Num     Type           Disp Enb Address            What</span>
<span class="go">1       breakpoint     keep y   0x00007ffff6b9c00b in ip4_icmp_input at /scratch/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">    breakpoint already hit 3 times</span>
<span class="go">3       breakpoint     keep y   0x00007ffff640f646 in tw_timer_expire_timers_internal_1t_3w_1024sl_ov</span>
<span class="go">    at /scratch/vpp-master/build-data/../src/vppinfra/tw_timer_template.c:775</span>
</pre></div>
</div>
</div>
<div class="section" id="step-next-list">
<h2>Step/Next/List<a class="headerlink" href="#step-next-list" title="Permalink to this headline">¶</a></h2>
<p>Step through the code using (s)tep into, (n)ext, and list some lines before and after where you are with list.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">Thread 1 &quot;vpp_main&quot; hit Breakpoint 1, ip4_icmp_input (vm=0x7ffff7b89a40 &lt;vlib_global_main&gt;, node=0x7fffb6bb6900, frame=0x7fffb6709480)</span>
<span class="go">    at /scratch/jdenisco/vpp-master/build-data/../src/vnet/ip/icmp4.c:142</span>
<span class="go">142 {</span>
<span class="go">(gdb) n</span>
<span class="go">143   icmp4_main_t *im = &amp;icmp4_main;</span>
<span class="go">(</span>
<span class="go">(gdb) list</span>
<span class="go">202       vlib_put_next_frame (vm, node, next, n_left_to_next);</span>
<span class="go">203     }</span>
<span class="go">204</span>
<span class="go">205   return frame-&gt;n_vectors;</span>
<span class="go">206 }</span>
<span class="go">207</span>
<span class="go">208 /* *INDENT-OFF* */</span>
<span class="go">209 VLIB_REGISTER_NODE (ip4_icmp_input_node,static) = {</span>
<span class="go">210   .function = ip4_icmp_input,</span>
<span class="go">211   .name = &quot;ip4-icmp-input&quot;,</span>
</pre></div>
</div>
</div>
<div class="section" id="examining-data-and-packets">
<h2>Examining Data and packets<a class="headerlink" href="#examining-data-and-packets" title="Permalink to this headline">¶</a></h2>
<p>To look at data and packets use e(x)amine or (p)rint.</p>
<p>For example in this code look at the ip packet:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) p/x *ip0</span>
<span class="gp">$</span><span class="nv">3</span> <span class="o">=</span> <span class="o">{{</span><span class="nv">ip_version_and_header_length</span> <span class="o">=</span> 0x45, <span class="nv">tos</span> <span class="o">=</span> 0x0, <span class="nv">length</span> <span class="o">=</span> 0x5400,
<span class="go">fragment_id = 0x7049, flags_and_fragment_offset = 0x40, ttl = 0x40, protocol = 0x1,</span>
<span class="go">checksum = 0x2ddd, {{src_address = {data = {0xa, 0x0, 0x0, 0x2},</span>
<span class="go">data_u32 = 0x200000a, as_u8 = {0xa, 0x0, 0x0, 0x2}, as_u16 = {0xa, 0x200},</span>
<span class="go">as_u32 = 0x200000a}, dst_address = {data = {0xa, 0x0, 0x0, 0xa}, data_u32 = 0xa00000a,</span>
<span class="go">as_u8 = {0xa, 0x0, 0x0, 0xa}, as_u16 = {0xa, 0xa00},  as_u32 = 0xa00000a}},</span>
<span class="go">address_pair = {src = {data = {0xa, 0x0, 0x0, 0x2}, data_u32 = 0x200000a,</span>
<span class="go">as_u8 = {0xa, 0x0, 0x0, 0x2}, as_u16 = {0xa, 0x200},  as_u32 = 0x200000a},</span>
<span class="go">dst = {data = {0xa, 0x0, 0x0, 0xa}, data_u32 = 0xa00000a, as_u8 = {0xa, 0x0, 0x0, 0xa},</span>
<span class="go">as_u16 = {0xa, 0xa00}, as_u32 = 0xa00000a}}}}, {checksum_data_64 =</span>
<span class="go">{0x40704954000045, 0x200000a2ddd0140}, checksum_data_64_32 = {0xa00000a}},</span>
<span class="go">{checksum_data_32 = {0x54000045, 0x407049, 0x2ddd0140, 0x200000a, 0xa00000a}}}</span>
</pre></div>
</div>
<p>Then the icmp header</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) p/x *icmp0</span>
<span class="gp">$</span><span class="nv">4</span> <span class="o">=</span> <span class="o">{</span><span class="nb">type</span> <span class="o">=</span> 0x8, <span class="nv">code</span> <span class="o">=</span> 0x0, <span class="nv">checksum</span> <span class="o">=</span> 0xf148<span class="o">}</span>
</pre></div>
</div>
<p>Then look at the actual bytes:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="go">(gdb) x/50w ip0</span>
<span class="go">0x7fde9953510e:     0x54000045      0x00407049      0x2ddd0140      0x0200000a</span>
<span class="go">0x7fde9953511e:     0x0a00000a      0xf1480008      0x03000554      0x5b6b2e8a</span>
<span class="go">0x7fde9953512e:     0x00000000      0x000ca99a      0x00000000      0x13121110</span>
<span class="go">0x7fde9953513e:     0x17161514      0x1b1a1918      0x1f1e1d1c      0x23222120</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="add_plugin.html" class="btn btn-neutral float-right" title="Adding a plugin" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="running_vpp.html" class="btn btn-neutral float-left" title="Running VPP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Linux Foundation

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>