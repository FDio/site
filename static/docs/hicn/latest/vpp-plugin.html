

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>VPP plugin &mdash; Hybrid ICN 20.01 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/rules.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Transport Library" href="transport.html" />
    <link rel="prev" title="Core Library" href="lib.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Hybrid ICN
          

          
            
            <img src="_static/fd-io_red_white.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="started.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="lib.html">Core Library</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VPP plugin</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-start">Quick Start</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-hicn-plugin">Using hICN plugin</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#dependencies">Dependencies</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setup-the-host-for-vpp">Setup the host for VPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-vpp">Configure VPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start-vpp">Start VPP</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-hicn-plugin">Configure hICN plugin</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#hicn-plugin-cli">hICN plugin CLI</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hicn-plugin-configuration-file">hICN plugin configuration file</a></li>
<li class="toctree-l4"><a class="reference internal" href="#hicn-plugin-binary-api">hICN plugin binary API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example-consumer-and-producer-ping">Example: consumer and producer Ping</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#forwarder-a">Forwarder A</a></li>
<li class="toctree-l4"><a class="reference internal" href="#forwarder-b">Forwarder B</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transport.html">The Transport Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="hicn-light.html">Portable Forwarder</a></li>
<li class="toctree-l1"><a class="reference internal" href="interface.html">Face Manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="control.html">Control Plane Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="telemetry.html">Telemetry</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">Utility applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="apps.html">Applications</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Hybrid ICN</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>VPP plugin</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/vpp-plugin.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="vpp-plugin">
<h1>VPP plugin<a class="headerlink" href="#vpp-plugin" title="Permalink to this headline">¶</a></h1>
<p>The hICN-plugin forwarder</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>A high-performance Hybrid ICN forwarder as a plugin to VPP.</p>
<p>The plugin provides the following functionalities:</p>
<ul class="simple">
<li><p>Fast packet processing</p></li>
<li><p>Interest aggregation</p></li>
<li><p>Content caching</p></li>
<li><p>Forwarding strategies</p></li>
</ul>
</div>
<div class="section" id="quick-start">
<h2>Quick Start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>From the code tree root

<span class="o">(</span>VPP installed with DEB pkg<span class="o">)</span>
$ <span class="nb">cd</span> hicn-plugin
$ mkdir -p build
$ <span class="nb">cd</span> build
$ cmake .. -DCMAKE_INSTALL_PREFIX<span class="o">=</span>/usr
$ make
$ sudo make install

<span class="o">(</span>VPP <span class="nb">source</span> code -- build <span class="nb">type</span> RELEASE<span class="o">)</span>
$ <span class="nb">cd</span> hicn-plugin
$ mkdir -p build
$ <span class="nb">cd</span> build
$ cmake .. -DVPP_HOME<span class="o">=</span>&lt;vpp dir&gt;/build-root/install-vpp-native/vpp -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;vpp src&gt;/build-root/install-vpp-native/vpp
$ make
$ sudo make install

<span class="o">(</span>VPP <span class="nb">source</span> code -- build <span class="nb">type</span> DEBUG<span class="o">)</span>
$ <span class="nb">cd</span> hicn-plugin
$ mkdir -p build
$ <span class="nb">cd</span> build
$ cmake .. -DCMAKE_BUILD_TYPE<span class="o">=</span>DEBUG -DVPP_HOME<span class="o">=</span>&lt;vpp dir&gt;/build-root/install-vpp_debug-native/vpp -DCMAKE_INSTALL_PREFIX<span class="o">=</span>&lt;vpp src&gt;/build-root/install-vpp_debug-native/vpp
$ make
$ sudo make install

CMAKE variables:
- CMAKE_INSTALL_PREFIX -- <span class="nb">set</span> the install directory <span class="k">for</span> the hicn-plugin. This is the common path to the lib folder containing vpp_plugins and vpp_api_test_plugins folders. Default is /usr/local.
- VPP_HOME -- <span class="nb">set</span> the directory containing the include and lib directories of vpp.
</pre></div>
</div>
</div>
<div class="section" id="using-hicn-plugin">
<h2>Using hICN plugin<a class="headerlink" href="#using-hicn-plugin" title="Permalink to this headline">¶</a></h2>
<div class="section" id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h3>
<p>Build dependencies:</p>
<ul class="simple">
<li><p>VPP 20.01</p>
<ul>
<li><p>DEB packages (can be found <a class="reference external" href="https://packagecloud.io/fdio/release/install):">https://packagecloud.io/fdio/release/install):</a></p></li>
<li><p>vpp</p></li>
<li><p>libvppinfra-dev</p></li>
<li><p>vpp-dev</p></li>
</ul>
</li>
</ul>
<p>Runtime dependencies:</p>
<ul class="simple">
<li><p>VPP 20.01</p>
<ul>
<li><p>DEB packages (can be found <a class="reference external" href="https://packagecloud.io/fdio/release/install):">https://packagecloud.io/fdio/release/install):</a></p></li>
<li><p>vpp</p></li>
<li><p>vpp-plugin-core</p></li>
<li><p>vpp-plugin-dpdk (only to use DPDK compatible nics)</p></li>
</ul>
</li>
</ul>
<p>Hardware support (not mandatory):</p>
<ul class="simple">
<li><p><a class="reference external" href="http://DPDK.org/">DPDK</a> compatible NICs</p></li>
</ul>
</div>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>In order to start, the hICN plugin requires a running instance of VPP
The steps required to successfully start hICN are:</p>
<ul class="simple">
<li><p>Setup the host to run VPP</p></li>
<li><p>Configure VPP to use DPDK compatible nics</p></li>
<li><p>Start VPP</p></li>
<li><p>Configure VPP interfaces</p></li>
<li><p>Configure and start hICN</p></li>
</ul>
<p>Detailed information for configuring VPP can be found at <a class="reference external" href="https://wiki.fd.io/view/VPP">https://wiki.fd.io/view/VPP</a>.</p>
<div class="section" id="setup-the-host-for-vpp">
<h3>Setup the host for VPP<a class="headerlink" href="#setup-the-host-for-vpp" title="Permalink to this headline">¶</a></h3>
<p>Hugepages must be enabled in the system</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo sysctl -w vm.nr_hugepages<span class="o">=</span><span class="m">1024</span>
</pre></div>
</div>
<p>In order to use a DPDK interface, the <code class="docutils literal notranslate"><span class="pre">uio</span></code> and <code class="docutils literal notranslate"><span class="pre">uio_pci_generic</span></code> or <code class="docutils literal notranslate"><span class="pre">vfio_pci</span></code> modules need to be loaded in the kernel</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo modprobe uio
sudo modprobe uio_pci_generic
sudo modprobe vfio_pci
</pre></div>
</div>
<p>If the DPDK interface we want to assign to VPP is up, we must bring it down</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo ifconfig &lt;interface_name&gt; down
</pre></div>
</div>
<p>or</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo ip link <span class="nb">set</span> &lt;interface_name&gt; down
</pre></div>
</div>
</div>
<div class="section" id="configure-vpp">
<h3>Configure VPP<a class="headerlink" href="#configure-vpp" title="Permalink to this headline">¶</a></h3>
<p>The file /etc/VPP/startup.conf contains a set of parameters to setup VPP at startup.
The following example sets up VPP to use a DPDK interfaces:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>unix <span class="o">{</span>
  nodaemon
  log /tmp/vpp.log
  full-coredump
<span class="o">}</span>

api-trace <span class="o">{</span>
  on
<span class="o">}</span>

api-segment <span class="o">{</span>
  gid vpp
<span class="o">}</span>

dpdk <span class="o">{</span>
  dev <span class="m">0000</span>:08:00.0
<span class="o">}</span>

plugins <span class="o">{</span>
        <span class="c1">## Disable all plugins by default and then selectively enable specific plugins</span>
        plugin default <span class="o">{</span> disable <span class="o">}</span>
        plugin dpdk_plugin.so <span class="o">{</span> <span class="nb">enable</span> <span class="o">}</span>
        plugin acl_plugin.so <span class="o">{</span> <span class="nb">enable</span> <span class="o">}</span>
        plugin memif_plugin.so <span class="o">{</span> <span class="nb">enable</span> <span class="o">}</span>
        plugin hicn_plugin.so <span class="o">{</span> <span class="nb">enable</span> <span class="o">}</span>

        <span class="c1">## Enable all plugins by default and then selectively disable specific plugins</span>
        <span class="c1"># plugin dpdk_plugin.so { disable }</span>
        <span class="c1"># plugin acl_plugin.so { disable }</span>
<span class="o">}</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">0000:08:00.0</span></code> must be replaced with the actual PCI address of the DPDK interface</p>
</div>
<div class="section" id="start-vpp">
<h3>Start VPP<a class="headerlink" href="#start-vpp" title="Permalink to this headline">¶</a></h3>
<p>VPP can be started as a process or a service:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>Start VPP as a service in Ubuntu <span class="m">16</span>.04
$ sudo systemctl start vpp

Start VPP as a process in both <span class="m">16</span>.04
$ sudo vpp -c /etc/vpp/startup.conf
</pre></div>
</div>
</div>
<div class="section" id="configure-hicn-plugin">
<h3>Configure hICN plugin<a class="headerlink" href="#configure-hicn-plugin" title="Permalink to this headline">¶</a></h3>
<p>The hICN plugin can be configured either using the VPP command-line interface (CLI), through a configuration file or through the VPP binary api</p>
<div class="section" id="hicn-plugin-cli">
<h4>hICN plugin CLI<a class="headerlink" href="#hicn-plugin-cli" title="Permalink to this headline">¶</a></h4>
<p>The CLI commands for the hICN plugin start all with the hicn keyword. To see the full list of command available type:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo vppctl
vpp# hicn ?
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">control</span> <span class="pre">param</span></code>: configures the internal parameter of the hICN plugin. This command must be run before hicn control start.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn control param <span class="o">{</span> pit <span class="o">{</span> size &lt;entries&gt; <span class="p">|</span> <span class="o">{</span> dfltlife <span class="p">|</span> minlife <span class="p">|</span> maxlife <span class="o">}</span> &lt;seconds&gt; <span class="o">}</span> <span class="p">|</span> cs <span class="o">{</span>size &lt;entries&gt; <span class="p">|</span> app &lt;portion to reserved to app&gt;<span class="o">}</span> <span class="o">}</span>
  &lt;entries&gt;                     :set the maximum number of entry in the PIT or CS. Default <span class="k">for</span> PIT is <span class="m">131072</span>, <span class="k">for</span> CS is <span class="m">4096</span>. CS size cannot be grater than PIT size. Moreover CS size must be smaller than <span class="o">(</span><span class="c1"># of vlib buffer - 8196).</span>
  &lt;seconds&gt;                     :set the default, maximum or minimum lifetime of pit entries. Default value 2s <span class="o">(</span>default<span class="o">)</span>, <span class="m">0</span>.2s <span class="o">(</span>minumum<span class="o">)</span>, 20s <span class="o">(</span>maximum<span class="o">)</span>
  &lt;portion to reserved to app&gt;  :set the portion of CS to reserve to application running locally on the forwarder. Default is <span class="m">30</span>% of the cs size.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">control</span> <span class="pre">start</span></code>: starts the hICN plugin in VPP.</p>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">control</span> <span class="pre">stop</span></code> : stops the hICN plugin in VPP. Currently not supported.</p>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">face</span> <span class="pre">app</span></code> : manipulates producer and consumer application faces in the forwarder.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn face app <span class="o">{</span>add intfc &lt;sw_if&gt; <span class="o">{</span>prod prefix &lt;hicn_prefix&gt; cs_size &lt;size_in_packets&gt;<span class="o">}</span> <span class="o">{</span>cons<span class="o">}}</span> <span class="p">|</span> <span class="o">{</span>del &lt;face_id&gt;<span class="o">}</span>
  &lt;sw_if&gt;                     :software interface existing in vpp on top of which to create an application face
  &lt;hicn_prefix&gt;               :prefix to bound to the producer application face. Only content matching the prefix will be allowed through such face.
  &lt;size_in_packets&gt;           :content store size associated to the producer face.
  &lt;face_id&gt;                   :id of the face to remove
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">face</span> <span class="pre">ip</span></code>: manipulates ip application faces in the forwarder.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn face ip <span class="o">{</span>add <span class="o">[</span><span class="nb">local</span> &lt;src_address&gt;<span class="o">]</span> remote &lt;dst_address&gt; intfc &lt;sw_if&gt;<span class="o">}</span> <span class="p">|</span> <span class="o">{</span>del id &lt;face_id&gt;<span class="o">}</span>
  &lt;src_address&gt;               :the IPv4 or IPv6 <span class="nb">local</span> IP address to <span class="nb">bind</span> to <span class="o">(</span>not mandatory, <span class="k">if</span> not specified the <span class="nb">local</span> address is one of the address assigned to sw_if<span class="o">)</span>
  &lt;dst_address&gt;               :the IPv4 or IPv6 address of the remote system
  &lt;sw_if&gt;                     :software interface on thop of which we create the face
  &lt;face_id&gt;                   :id of the face to remove
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">face</span> <span class="pre">show</span></code>: list the available faces in the forwarder.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn face show <span class="o">[</span>&lt;face_id&gt;<span class="p">|</span> <span class="nb">type</span> &lt;ip/udp&gt;<span class="o">]</span>
  &lt;face_id&gt;                   :face id of which we want to display the informations
  &lt;ip/udp&gt;                    :shows all the ip or udp faces available
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">face</span> <span class="pre">udp</span></code>: manipulates udp application faces in the forwarder.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn face udp <span class="o">{</span>add src_addr &lt;src_address&gt; port &lt;src_port &gt; dst_addr &lt;dst_address&gt; port &lt;dst_port&gt;<span class="o">}</span> intfc &lt;sw_if&gt; <span class="p">|</span> <span class="o">{</span>del id &lt;face_id&gt;<span class="o">}</span>
  &lt;src_address&gt;             :the IPv4 or IPv6 <span class="nb">local</span> IP address to <span class="nb">bind</span> to
  &lt;src_port&gt;                :the <span class="nb">local</span> UDP port
  &lt;dst_address&gt;             :the IPv4 or IPv6 address of the remote system
  &lt;dst_port&gt;                :the remote UDP port
  &lt;sw_if&gt;                   :software interface on thop of which we create the face
  &lt;face_id&gt;                 :id of the face to remove
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">fib</span></code>: manipulates hicn fib entries.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn fib <span class="o">{{</span>add <span class="p">|</span> delete <span class="o">}</span> prefix &lt;prefix&gt; face &lt;face_id&gt; <span class="o">}</span> <span class="p">|</span> <span class="nb">set</span> strategy &lt;strategy_id&gt; prefix &lt;prefix&gt;
  &lt;prefix&gt;                  :prefix to add to the FIB
  &lt;face_id&gt;                 :face id to add as nexto hop in the FIB entry
  &lt;strategy_id&gt;             :set a strategy <span class="k">for</span> the corresponding prefix
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">pgen</span> <span class="pre">client</span></code>: set an vpp forwarder as an hicn packet generator client</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn pgen client fwd &lt;ip<span class="p">|</span>hicn&gt; src &lt;addr&gt; n_ifaces &lt;n_ifaces&gt; name &lt;prefix&gt; lifetime &lt;interest-lifetime&gt; intfc &lt;data in-interface&gt; max_seq &lt;max sequence number&gt; n_flows &lt;number of flows&gt;
  &lt;ip<span class="p">|</span>hicn&gt;                 :set <span class="k">if</span> the underlying forwarder is configured as ip or hicn
  &lt;src_addr&gt;                :source address to use in the interests, i.e., the locator <span class="k">for</span> routing the data packet back
  &lt;n_ifaces&gt;                :set the number of ifaces <span class="o">(</span>consumer faces<span class="o">)</span> to emulate. If more than one, each interest is sent &lt;n_ifaces&gt; times, each of it with a different <span class="nb">source</span> address calculated from &lt;src_addr&gt;
  &lt;prefix&gt;                  :prefix to use to generate hICN names
  &lt;interest-lifetime&gt;       :lifetime of the interests
  &lt;data in-interface&gt;       :interface through which the forwarder receives data
  &lt;max sequence number&gt;     :max the sequence number to use in the interest. Cycling between <span class="m">0</span> and this value
  &lt;number of flows&gt;         :emulate multiple flows downloaded in parallel
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">pgen</span> <span class="pre">server</span></code>: set an vpp forwarder as an hicn packet generator client</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn pgen server fwd &lt;ip<span class="p">|</span>hicn&gt; name &lt;prefix&gt; intfc &lt;interest in-interface&gt; size &lt;payload_size&gt;
  &lt;ip<span class="p">|</span>hicn&gt;                     :set <span class="k">if</span> the underlying forwarder is configured as ip or hicn
  &lt;prefix&gt;                      :prefix to use to reply to interest
  &lt;interest in-interface&gt;       :interface through which the forwarder receives interest
  &lt;payload_size&gt;                :size of the data payload
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">punting</span></code>: manipulates punting rules</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn punting <span class="o">{</span>add<span class="p">|</span>delete<span class="o">}</span> prefix &lt;prefix&gt; intfc &lt;sw_if&gt; <span class="o">{</span><span class="nb">type</span> ip <span class="p">|</span> <span class="nb">type</span> &lt;udp4<span class="p">|</span>udp6&gt; src_port &lt;src_port&gt; dst_port &lt;dst_port&gt;<span class="o">}</span>
  &lt;prefix&gt;                      :prefix to punt to the hICN plugin
  &lt;sw_if&gt;                       :software interface where to apply the punting
  &lt;ip<span class="p">|</span>udp4<span class="p">|</span>udp6&gt;                :creates a punting rule <span class="k">for</span> hICN packet encapsulated into a ip4/6<span class="p">|</span>udp tunnel or <span class="k">for</span> regular hicn packet
  &lt;src_port&gt;                    :source port of the udp4/6 tunnel
  &lt;dst_port&gt;                    :destination port of the udp4/6 tunnel
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">show</span></code>: show forwarder information.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn show <span class="o">[</span>detail<span class="o">]</span> <span class="o">[</span>strategies<span class="o">]</span>
  &lt;detail&gt;                      :shows additional details as pit,cs entries allocation/deallocation
  &lt;strategies&gt;                  :shows only the available strategies int he forwarder
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">hicn</span> <span class="pre">strategy</span> <span class="pre">mw</span> <span class="pre">set</span></code>: set the weight for a face.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>hicn strategy mw <span class="nb">set</span> prefix &lt;prefix&gt; face &lt;face_id&gt; weight &lt;weight&gt;
  &lt;prefix&gt;                      :prefix to which the strategy applies
  &lt;face_id&gt;                     :id of the face to <span class="nb">set</span> the weight
  &lt;weight&gt;                       :weight
</pre></div>
</div>
</div>
<div class="section" id="hicn-plugin-configuration-file">
<h4>hICN plugin configuration file<a class="headerlink" href="#hicn-plugin-configuration-file" title="Permalink to this headline">¶</a></h4>
<p>A configuration can be use to setup the hicn plugin when vpp starts. The configuration file is made of a list of CLI commands. In order to set vpp to read the configuration file, the file /etc/vpp/startup.conf needs to be modified as follows:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>unix <span class="o">{</span>
  nodaemon
  log /tmp/vpp.log
  full-coredump
  startup-config &lt;path to configuration file&gt;
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="hicn-plugin-binary-api">
<h4>hICN plugin binary API<a class="headerlink" href="#hicn-plugin-binary-api" title="Permalink to this headline">¶</a></h4>
<p>The binary api, or the vapi, can be used as well to configure the hicn plugin. For each cli command there is a corresponding message in the binary api. The list of messages is available in the file hicn.api (located in hicn/hicn-plugin/src/)</p>
</div>
</div>
<div class="section" id="example-consumer-and-producer-ping">
<h3>Example: consumer and producer Ping<a class="headerlink" href="#example-consumer-and-producer-ping" title="Permalink to this headline">¶</a></h3>
<p>In this example, we connect two vpp forwarders, A and B, each of them running the hicn plugin. On top of forwarder A we run the ping_client application, on top of forwarder B we run the ping_server application. Each application connects to the underlying forwarder through a memif-interface. The two forwarders are connected through a dpdk link.</p>
<div class="section" id="forwarder-a">
<h4>Forwarder A<a class="headerlink" href="#forwarder-a" title="Permalink to this headline">¶</a></h4>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo vppctl
vpp# <span class="nb">set</span> interface ip address TenGigabitEtherneta/0/0 <span class="m">2001</span>::2/64
vpp# <span class="nb">set</span> interface state TenGigabitEtherneta/0/0 up
vpp# hicn control start
vpp# hicn face ip add <span class="nb">local</span> <span class="m">2001</span>::2 remote <span class="m">2001</span>::3 intfc TenGigabitEtherneta/0/0
vpp# hicn fib add prefix b002::1/64 face <span class="m">0</span>
vpp# hicn punting add prefix b002::1/64 intfc TenGigabitEtherneta/0/0 <span class="nb">type</span> ip
</pre></div>
</div>
</div>
<div class="section" id="forwarder-b">
<h4>Forwarder B<a class="headerlink" href="#forwarder-b" title="Permalink to this headline">¶</a></h4>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$ sudo vppctl
vpp# <span class="nb">set</span> interface ip address TenGigabitEtherneta/0/1 <span class="m">2001</span>::3/64
vpp# <span class="nb">set</span> interface state TenGigabitEtherneta/0/1 up
vpp# hicn control start
vpp# hicn punting add prefix b002::1/64 intfc TenGigabitEtherneta/0/1 <span class="nb">type</span> ip
</pre></div>
</div>
<p>Once the two forwarder are started, run the ping_server application on the host where the forwarder B is running</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo ping_server -n b002::1
</pre></div>
</div>
<p>and the client on the host where forwarder B is running</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>sudo ping_client -n b002::1
</pre></div>
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="transport.html" class="btn btn-neutral float-right" title="The Transport Library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="lib.html" class="btn btn-neutral float-left" title="Core Library" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright (c) 2017-2020 Cisco and/or its affiliates.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>